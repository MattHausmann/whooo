#include <gb/gb.h>
#include <gb/cgb.h>



const UWORD spritepalette[] = {
	RGB_BLACK, RGB_DARKGRAY, RGB_RED, RGB_LIGHTFLESH
};

unsigned char spritetiles[] = {
	173,173,173,173,203,203,171,171,169,169,0,0,0,0,0,0,
	72,72,168,168,170,170,170,170,69,69,0,0,0,0,0,0,
	148,148,149,149,137,137,137,137,8,8,0,0,0,0,0,0,
	152,152,84,84,88,88,84,84,148,148,0,0,0,0,0,0,
	196,196,170,170,202,202,170,170,164,164,0,0,0,0,0,0,
	152,152,144,144,152,152,144,144,216,216,0,0,0,0,0,0,
};

unsigned char mario[] = {
	0, 7, 0, 15, 15, 1, 31, 11, 31, 9, 31, 7, 7, 7, 13, 2, 0, 192, 0, 248, 224, 160, 248, 184, 252, 220, 248, 128, 240, 240, 192, 0, 29, 2, 60, 3, 58, 55, 56, 63, 48, 63, 0, 14, 28, 0, 60, 0, 184, 64, 60, 192, 92, 236, 28, 252, 12, 252, 0, 112, 56, 0, 60, 0
};


const UWORD backgroundpalette[] = {
	RGB_BLACK, RGB_DARKGRAY, RGB_LIGHTGRAY, RGB_WHITE,
	RGB_RED, RGB_YELLOW, RGB_BLUE, RGB_GREEN
};
unsigned char backgroundcharacters[] = {
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,
	255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,
	0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,
	255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255
};
const unsigned char bgmap[] = {
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

};
	const unsigned char cgbmap[] = {
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
};
int i = 0;
int spritey = 20;
int spritex = 20;
int main()
{
	//sprite stuff
	set_sprite_palette(0,1,&spritepalette[0]);
	SPRITES_8x8;
	set_sprite_data(0, 4, mario);	
	set_sprite_prop(0,0);
	set_sprite_prop(1,0);
	set_sprite_prop(2,0);
	set_sprite_prop(3,0);
	set_sprite_tile(0,0);
	set_sprite_tile(1,1);
	set_sprite_tile(2,2);
	set_sprite_tile(3,3);


	move_sprite(0,20,spritey);
	move_sprite(1,28,spritey);
	move_sprite(2,20,spritey+8);
	move_sprite(3,28,spritey+8);

	//background stuff
	set_bkg_palette(0,1,&backgroundpalette[0]);
	set_bkg_palette(1,1,&backgroundpalette[4]);
	set_bkg_data(0,4,backgroundcharacters);
	VBK_REG=1;
	set_bkg_tiles(0,0,20,24,cgbmap);
	VBK_REG=0;
	set_bkg_tiles(0,0,20,24,bgmap);
	SHOW_BKG;
	enable_interrupts();
	DISPLAY_ON;
	scroll_bkg(0,1);
	while(1) {
		i++;
		if(i == 6000) {

		scroll_bkg(1,0);
			VBK_REG=1;
	set_bkg_tiles(0,0,20,19,cgbmap);
	VBK_REG=0;
	set_bkg_tiles(0,0,20,19,bgmap);
	SHOW_BKG;

	if(joypad() & J_UP) {
		spritey--;
	}
	if(joypad() & J_DOWN) {
		spritey++;
	}
	if(joypad() & J_LEFT) {
		spritex--;
	}
	if(joypad() & J_RIGHT) {
		spritex++;
	}
	move_sprite(0,spritex,spritey);
	move_sprite(1,spritex+8,spritey);
	move_sprite(2,spritex,spritey+8);
	move_sprite(3,spritex+8,spritey+8);

	SHOW_SPRITES;
		i = 0;
		}
		
	}
	return 0;
}
